# 微前端
## 微前端是什么？
与多个可以独立发布功能的团队一起构建现代化的web应用程序的“技术策略和方法”！
把整个前端大的整体分成一个一个小而简单的块，这些块可以进行独立的开发构建部署，并且这些块又可以聚合在一起，形成一个产品在客户面前展示。
也可以理解为微前端就是把多个可独立交付的小型前端应用聚合在一个整体应用的架构风格。
## 如何实现多个应用项目之间的资源共享？
之前我们会使用npm包的形式来进行抽离和引用，但是这样会有几个问题：1.发布效率低，如果需要迭代业务逻辑，可能需要先发布包，然后再每个使用到这个模块的地方再去更新一次，我们又得再构建发布。2.多团队协作很不规范，一个团队一个风格，团队技术管理是比较麻烦的。
## 微前端解决了什么问题呢？
如果项目非常大，或者项目时间过久，更新非常繁琐，这时候就可以考虑微前端。
## 微前端的架构特点？
1. 独立部署 
2. 增量迁移 例如angular迁移到react，对版本有要求。
3. 团队自治 拆分之后就可以分给不同的团队，每个团队只需要干好自己的块就行了
4. 松耦合代码 代码的耦合性比较低
## 微前端的架构方案？
1. 自由组织模式 自己玩，不借助框架，但是要约定好，但是会经常遇到第三方依赖处理的问题（systemjs来解决）。
2. 基座模式 通过搭建一个基座配套配置中心来管理子应用。一个大的基座来包裹所有的应用。目前应用个最广。single-spa  qiankun就是个例子。
3. 去中心模式  脱离基座模式，每个应用之间都可以进行分享资源，也就是webpack5中的模块联邦的模式。
## single-spa
是一个微前端的框架
有三种类型的微前端应用：
1. single-spa-application/parcel:微前端架构中的微应用，可以使用react，vue，angular等框架。
2. single-spa root config： 创建微前端的基座。
3. utility modules：公共模块应用，非渲染组件，用于跨应用共享js逻辑的微应用。
## single-spa的使用：
#### 安装single-spa
这里假如安装2.0.3版本：npm install create-single-apa@2.0.3 -g
#### 先创建基座
输入命令 create-single-spa
对我们创建的基座进行配置 ，注意select type to generate ? 选择第三个single-spa root config，创建我们的基座。
#### 再创建我们的应用
再次输入我们的命令 create-single-spa
此时选择我们select type to generate ?选择第一个single-spa application，创建我们的应用。
#### 这里需要注意的是
我们需要先启动我们的应用，然后我们才能使用我们的基座来找到我们的应用。所以最好在启动我们的应用的时候我们设置好启动的端口号。
#### 启动我们的应用
我们此时会得到“Your Microfrontend is not here”的提示，这是因为我们的应用是不可以直接访问的，而是需要通过我们的基座进行访问，也就是需要在基座中进行配置。
#### 在基座中的注册我们的应用
1. 在我们的团队名-root-config.js文件中，使用registerApplication()方法来进行注册。
不会配置，照着例子抄就好啦。
name：应用的名字。
app：函数，引入我们的应用。
activeWhen：匹配对应的路由。如果需要注意精准匹配的问题。
registerApplication()的参数也可以不为对象，可以将对象的三个属性，分开传入。
也就是：registerApplication(name，app，location=>location.pathname==='我们配置的路由')
2. 然后我们要对我们的项目依赖进行处理。
我们所有应用用到的依赖都使用基座来进行加载。所以也需要再基座中进行配置。
也就是在我们的index.ejs文件中引入我们需要的内容，具体依赖的地址官方有给。
3. 在index.ejs文件中添加上我们的应用。
这里需要注意的是，如果是本地应用的话，我们的链接开头是不包含协议的，也就是使用//开头。
具体链接内容参见你刚才启动我们的应用时候的提示页面中有包含这里需要的链接，复制一下即可。
#### 把我们的应用具体到基座的某个位置
1. 我们可以在我们的基座的index.ejs的body中进行配置。
和react的reactDOM.render()方法相似，我们需要先设置一个具体的位置，所以我们需要自己设置一个基座，然后使用id标记他的位置。
2. 然后在我们的应用的团队-项目名.js文件中的singleSpaReact()方法中添加第二个参数:
domElementGetter:()=>document.getElementById('我们上一步做的标记')


总结：构建基座-构建应用-启动应用-基座中注册应用-基座中添加应用依赖项的配置-基座中配置应用的地址。